[2022-06-10 07:08:33,916] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: hands_on_test.create_hive_restaurant_detail_new manual__2022-06-10T06:57:39.204816+00:00 [queued]>
[2022-06-10 07:08:33,938] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: hands_on_test.create_hive_restaurant_detail_new manual__2022-06-10T06:57:39.204816+00:00 [queued]>
[2022-06-10 07:08:33,939] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-06-10 07:08:33,940] {taskinstance.py:1357} INFO - Starting attempt 1 of 2
[2022-06-10 07:08:33,941] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-06-10 07:08:33,976] {taskinstance.py:1377} INFO - Executing <Task(BashOperator): create_hive_restaurant_detail_new> on 2022-06-10 06:57:39.204816+00:00
[2022-06-10 07:08:33,989] {standard_task_runner.py:52} INFO - Started process 1133 to run task
[2022-06-10 07:08:33,997] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'hands_on_test', 'create_hive_restaurant_detail_new', 'manual__2022-06-10T06:57:39.204816+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/dag.py', '--cfg-path', '/tmp/tmp8bxvu4yo', '--error-file', '/tmp/tmp2a1b73up']
[2022-06-10 07:08:34,000] {standard_task_runner.py:80} INFO - Job 44: Subtask create_hive_restaurant_detail_new
[2022-06-10 07:08:34,138] {task_command.py:369} INFO - Running <TaskInstance: hands_on_test.create_hive_restaurant_detail_new manual__2022-06-10T06:57:39.204816+00:00 [running]> on host a0fd966c00bf
[2022-06-10 07:08:34,299] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=hands_on_test
AIRFLOW_CTX_TASK_ID=create_hive_restaurant_detail_new
AIRFLOW_CTX_EXECUTION_DATE=2022-06-10T06:57:39.204816+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-06-10T06:57:39.204816+00:00
[2022-06-10 07:08:34,302] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2022-06-10 07:08:34,304] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'docker exec hive-server hive -f /opt/hql/restaurant_detail_new.hql ']
[2022-06-10 07:08:34,340] {subprocess.py:85} INFO - Output:
[2022-06-10 07:08:38,500] {subprocess.py:92} INFO - SLF4J: Class path contains multiple SLF4J bindings.
[2022-06-10 07:08:38,501] {subprocess.py:92} INFO - SLF4J: Found binding in [jar:file:/opt/hive/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
[2022-06-10 07:08:38,502] {subprocess.py:92} INFO - SLF4J: Found binding in [jar:file:/opt/hadoop-2.7.4/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
[2022-06-10 07:08:38,502] {subprocess.py:92} INFO - SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
[2022-06-10 07:08:38,504] {subprocess.py:92} INFO - SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
[2022-06-10 07:08:40,849] {subprocess.py:92} INFO - 
[2022-06-10 07:08:40,851] {subprocess.py:92} INFO - Logging initialized using configuration in file:/opt/hive/conf/hive-log4j2.properties Async: true
[2022-06-10 07:08:48,434] {subprocess.py:92} INFO - OK
[2022-06-10 07:08:48,438] {subprocess.py:92} INFO - Time taken: 4.527 seconds
[2022-06-10 07:08:48,920] {subprocess.py:92} INFO - OK
[2022-06-10 07:08:48,921] {subprocess.py:92} INFO - Time taken: 0.477 seconds
[2022-06-10 07:08:49,360] {subprocess.py:92} INFO - OK
[2022-06-10 07:08:49,374] {subprocess.py:92} INFO - Partitions not in metastore:	restaurant_detail_new:dt=latest
[2022-06-10 07:08:49,376] {subprocess.py:92} INFO - Repair: Added partition to metastore restaurant_detail_new:dt=latest
[2022-06-10 07:08:49,390] {subprocess.py:92} INFO - Time taken: 0.449 seconds, Fetched: 2 row(s)
[2022-06-10 07:08:56,599] {subprocess.py:92} INFO - WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
[2022-06-10 07:08:56,603] {subprocess.py:92} INFO - Query ID = root_20220610070849_35b76922-3acb-4654-8c80-a2eb3c08eb8b
[2022-06-10 07:08:56,604] {subprocess.py:92} INFO - Total jobs = 1
[2022-06-10 07:08:56,626] {subprocess.py:92} INFO - Launching Job 1 out of 1
[2022-06-10 07:08:56,630] {subprocess.py:92} INFO - Number of reduce tasks determined at compile time: 1
[2022-06-10 07:08:56,631] {subprocess.py:92} INFO - In order to change the average load for a reducer (in bytes):
[2022-06-10 07:08:56,632] {subprocess.py:92} INFO -   set hive.exec.reducers.bytes.per.reducer=<number>
[2022-06-10 07:08:56,633] {subprocess.py:92} INFO - In order to limit the maximum number of reducers:
[2022-06-10 07:08:56,634] {subprocess.py:92} INFO -   set hive.exec.reducers.max=<number>
[2022-06-10 07:08:56,635] {subprocess.py:92} INFO - In order to set a constant number of reducers:
[2022-06-10 07:08:56,636] {subprocess.py:92} INFO -   set mapreduce.job.reduces=<number>
[2022-06-10 07:08:59,549] {subprocess.py:92} INFO - Job running in-process (local Hadoop)
[2022-06-10 07:09:00,795] {subprocess.py:92} INFO - 2022-06-10 07:09:00,793 Stage-1 map = 0%,  reduce = 0%
[2022-06-10 07:09:01,277] {subprocess.py:92} INFO - SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
[2022-06-10 07:09:01,279] {subprocess.py:92} INFO - SLF4J: Defaulting to no-operation (NOP) logger implementation
[2022-06-10 07:09:01,280] {subprocess.py:92} INFO - SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
[2022-06-10 07:09:04,868] {subprocess.py:92} INFO - 2022-06-10 07:09:04,865 Stage-1 map = 100%,  reduce = 0%
[2022-06-10 07:09:05,886] {subprocess.py:92} INFO - 2022-06-10 07:09:05,885 Stage-1 map = 100%,  reduce = 100%
[2022-06-10 07:09:05,936] {subprocess.py:92} INFO - Ended Job = job_local583512388_0001
[2022-06-10 07:09:06,016] {subprocess.py:92} INFO - MapReduce Jobs Launched:
[2022-06-10 07:09:06,022] {subprocess.py:92} INFO - Stage-Stage-1:  HDFS Read: 533724 HDFS Write: 0 SUCCESS
[2022-06-10 07:09:06,026] {subprocess.py:92} INFO - Total MapReduce CPU Time Spent: 0 msec
[2022-06-10 07:09:06,031] {subprocess.py:92} INFO - OK
[2022-06-10 07:09:06,211] {subprocess.py:92} INFO - 12623
[2022-06-10 07:09:06,217] {subprocess.py:92} INFO - Time taken: 16.639 seconds, Fetched: 1 row(s)
[2022-06-10 07:09:06,939] {subprocess.py:92} INFO - OK
[2022-06-10 07:09:07,096] {subprocess.py:92} INFO - R_99988	Restaurant A	BREAKFAST	69.0	2	13.59705995	100.74540140	latest
[2022-06-10 07:09:07,097] {subprocess.py:92} INFO - R_99983	Restaurant B	BREAKFAST	43.0	2	13.74610800	100.52930400	latest
[2022-06-10 07:09:07,098] {subprocess.py:92} INFO - R_99976	Restaurant C	BREAKFAST	70.0	2	13.99500277	100.65400990	latest
[2022-06-10 07:09:07,099] {subprocess.py:92} INFO - R_99970	Restaurant D	BREAKFAST	70.0	2	14.04092269	100.60976740	latest
[2022-06-10 07:09:07,100] {subprocess.py:92} INFO - R_99968	Restaurant E	BREAKFAST	20.0	1	13.71098548	100.40930720	latest
[2022-06-10 07:09:07,103] {subprocess.py:92} INFO - Time taken: 0.717 seconds, Fetched: 5 row(s)
[2022-06-10 07:09:07,330] {subprocess.py:92} INFO - OK
[2022-06-10 07:09:07,377] {subprocess.py:92} INFO - CREATE EXTERNAL TABLE `restaurant_detail_new`(
[2022-06-10 07:09:07,379] {subprocess.py:92} INFO -   `id` string,
[2022-06-10 07:09:07,381] {subprocess.py:92} INFO -   `restaurant_name` string,
[2022-06-10 07:09:07,385] {subprocess.py:92} INFO -   `category` string,
[2022-06-10 07:09:07,388] {subprocess.py:92} INFO -   `estimated_cooking_time` float,
[2022-06-10 07:09:07,390] {subprocess.py:92} INFO -   `cooking_bin` int,
[2022-06-10 07:09:07,393] {subprocess.py:92} INFO -   `latitude` decimal(11,8),
[2022-06-10 07:09:07,395] {subprocess.py:92} INFO -   `longitude` decimal(11,8))
[2022-06-10 07:09:07,397] {subprocess.py:92} INFO - PARTITIONED BY (
[2022-06-10 07:09:07,399] {subprocess.py:92} INFO -   `dt` string)
[2022-06-10 07:09:07,401] {subprocess.py:92} INFO - ROW FORMAT SERDE
[2022-06-10 07:09:07,404] {subprocess.py:92} INFO -   'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
[2022-06-10 07:09:07,407] {subprocess.py:92} INFO - STORED AS INPUTFORMAT
[2022-06-10 07:09:07,408] {subprocess.py:92} INFO -   'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
[2022-06-10 07:09:07,411] {subprocess.py:92} INFO - OUTPUTFORMAT
[2022-06-10 07:09:07,412] {subprocess.py:92} INFO -   'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
[2022-06-10 07:09:07,414] {subprocess.py:92} INFO - LOCATION
[2022-06-10 07:09:07,416] {subprocess.py:92} INFO -   'hdfs://namenode:8020/user/spark/restaurant_detail_new'
[2022-06-10 07:09:07,418] {subprocess.py:92} INFO - TBLPROPERTIES (
[2022-06-10 07:09:07,420] {subprocess.py:92} INFO -   'transient_lastDdlTime'='1654844928')
[2022-06-10 07:09:07,421] {subprocess.py:92} INFO - Time taken: 0.223 seconds, Fetched: 20 row(s)
[2022-06-10 07:09:08,387] {subprocess.py:96} INFO - Command exited with return code 0
[2022-06-10 07:09:08,462] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=hands_on_test, task_id=create_hive_restaurant_detail_new, execution_date=20220610T065739, start_date=20220610T070833, end_date=20220610T070908
[2022-06-10 07:09:08,533] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-10 07:09:08,645] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
